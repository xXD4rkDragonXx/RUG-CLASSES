\documentclass{report}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}

\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codeorange}{rgb}{1,0.49,0}
\definecolor{backcolour}{rgb}{0.95,0.95,0.96}

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  backgroundcolor=\color{backcolour},
  numbers=left,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

\title{Information Security Assignment 1}
\author{
    Stijn Kammer (S4986296)
    \and Ramon Kits (S5440769)
}
\date{September 2022}

\begin{document}

\maketitle

\section*{Exercise 1}
The \href{
      https://www.rug.nl/society-business/centre-for-information-technology/security/aup/
}{University of Groningen's Acceptable Use Policy},
or also known as the AUP of the RUG, is a document describing general rules for
using the computer systems of the University of Groningen.\\
Below we will discuss some questions about the AUP.

\begin{enumerate}
      \item \textbf{What (if any) are the differences between the responsibilities of `ordinary'
                  users and systems managers? Do systems managers have special privileges
                  and responsibilities (if so, what are they)?}

            The rights and duties of both users and systems managers are the same.
            But the position of the systems manager comes with additional security requirements.
            The main difference boils down to one of the later points in the
            \href{
                  https://www.rug.nl/society-business/centre-for-information-technology/security/aup/#:~:text=systems%20managers%27%2C%20below).-,Responsibilities%20of%20systems%20managers,nature%20of%20their%20positions%20naturally%20leads%20to%20additional%20security%20related%20requirements.,-Systems%20managers%20should
            }{list}
            in the AUP;
            "The systems manager will consider any information about the system, as well as any
            information stored in the system as confidential." Which means that the systems manager
            should not share private information which he or she might encounter while working.

      \item \textbf{What is the ground-rule upon which the RUG's AUP is based?}
            "The users of the university computer systems may not endanger these systems, nor may they hinder other users."
            \href{
                  https://www.rug.nl/society-business/centre-for-information-technology/security/aup/#:~:text=the%20users%20of%20the%20university%20computer%20systems%20may%20not%20endanger%20these%20systems%2C%20nor%20may%20they%20hinder%20other%20users.
            }{This} is stated near the start of the document.

      \item \textbf{Mention four advices for users of `RuGnet';}
            \begin{enumerate}
                  \item \textbf{Data is being monitored.}
                        in- and outbound traffic of RuGnet is constantly monitored,
                        this means it not adviced to use RuGnet for illegal activities or to sent private information.
                        Any use of the university computer systems is restricted to research or education.
                  \item \textbf{Copying software.}
                        Any software stored on the university computer systems may not be copied for use elsewhere,
                        unless explicit and written permission was granted by proper authorities.
                  \item \textbf{Do not share your password.}
                        The password of your account should not be shared with anyone.
                        If you suspect that your password has been compromised,
                        you should change it immediately. To minimize the risk of your password being compromised,
                        you should use a strong password.
                  \item \textbf{Check for any hardware abnormalities.}
                        If you notice any abnormalities in the hardware of the computer systems,
                        you should report it immediately to the ICT department and not use that device.
                        abnormalities can be anything from unexpected extra periffirals connected to the device,
                        to the keyboard being plugged in a seperate device before it connects to the computer or device.
            \end{enumerate}

      \item \textbf{Describe four actions that are prohibited by the RuG's AUP;}
            Following actions are taken directly from the secion
            "\href{
                  https://www.rug.nl/society-business/centre-for-information-technology/security/aup/#:~:text=The%20abuse%20of%20facilities%20and%20privileges
            }{The abuse of facilities and privileges}"
            in the AUP:
            \begin{enumerate}
                  \item \textbf{Removing soft- or hardware.}
                        The removal of any software or hardware from the university computer systems is prohibited.
                  \item \textbf{Using computer systems without permission.}
                        It is prohibited to use any computer system without permission from proper authorities.
                  \item \textbf{Executing DoS attacks.}
                        It is prohibited to execute any kind of Denial of Service attacks on any computer system
                        or the network around it. Examples of this are, submitting extremely large print-jobs,
                        storing extremely large amounts of data, or executing programs using grossly inefficient algorithms
                        or requiring excessively large resources.
                  \item \textbf{Distributing information that belongs to the university.}
                        It is prohibited to distribute information that belongs to the university,
                        unless explicit and written permission was granted by proper authorities or owner of the information.
            \end{enumerate}

      \item \textbf{What sanctions can be applied to those who violate the AUP?}
            As stated in
            \href{
                  https://www.rug.nl/society-business/centre-for-information-technology/security/aup/#:~:text=Consequences%20of%20abusing%20the%20University%20computer%20systems
            }{Consequences of abusing the University computer systems},
            Abusing university computer systems may result in disciplinary action.
            This includes the access rights of the suspect being restricted or suspended,
            awaiting the results of the investigation which will take place by. Either way,
            the faculty or department responsible for the suspect will be informed.

      \item \textbf{If a sanction is applied to you, where can you go to challenge that sanction?}
            You may file an objection to this restriction or suspension with the chair of your department.

\end{enumerate}

\section*{Exercise 2}

\begin{lstlisting}
      
import string


# substitution cypher

# Encrypts a string using a shift cypher
def encryptShift(plain_text, key):
    cipher_text = ""
    for char in plain_text:
        if char.isalpha():
            if char.isupper():
                cipher_text += chr((ord(char) + int(key) - 65) % 26 + 65)
            else:
                cipher_text += chr((ord(char) + int(key) - 97) % 26 + 97)
        else:
            cipher_text += char
    return cipher_text

# Decrypts a string using a shift cypher
def decryptShift(cipher_text, key):
    plain_text = ""
    for char in cipher_text:
        if char.isalpha():
            if char.isupper():
                plain_text += chr((ord(char) - int(key) - 65) % 26 + 65)
            else:
                plain_text += chr((ord(char) - int(key) - 97) % 26 + 97)
        else:
            plain_text += char
    return plain_text

# Encrypts a string using a mapping cypher
def encryptMapping(plain_text, mapping):
    cipher_text = ""
    for char in plain_text:
        if char.isalpha():
            if char.isupper():
                cipher_text += mapping[ord(char) - 65].upper()
            else:
                cipher_text += mapping[ord(char) - 97]
        else:
            cipher_text += char
    return cipher_text

# Decrypts a string using a mapping cypher
def decryptMapping(cipher_text, mapping):
    plain_text = ""
    for char in cipher_text:
        if char.isalpha():
            if char.isupper():
                plain_text += chr(mapping.index(char.lower()) + 97).upper()
            else:
                plain_text += chr(mapping.index(char) + 97)
        else:
            plain_text += char
    return plain_text

# Handles the input from the user
def handle_input(query):
    mappingoffset = string.ascii_lowercase
    steps = query.split(" ")
    for i in range(0, len(steps), 2):
        map_or_shift = stringToInt(steps[i+1])
        if steps[i] == "d":
            if isinstance(map_or_shift, int):
                mappingoffset = decryptShift(mappingoffset, map_or_shift)
            else:
                mappingoffset = decryptMapping(mappingoffset, map_or_shift)
        elif steps[i] == "e":
            if isinstance(map_or_shift, int):
                mappingoffset = encryptShift(mappingoffset, map_or_shift)
            else:
                mappingoffset = encryptMapping(mappingoffset, map_or_shift)
    return mappingoffset


# Converts a string to an int if possible
def stringToInt(string):
    try:
        value = int(string)
        return value
    except ValueError:
        return string

# Main function
def main():
    query = input()
    handled_input = handle_input(query)
    while(True):
        try:
            plain_text = input()
            print(encryptMapping(plain_text, handled_input))
        except EOFError:
            break

# Run main function
if __name__ == "__main__":
    main()

\end{lstlisting}

\section*{Exercise 3}

\begin{enumerate}
      \item \textbf{How many possible alphabets could be used in a substitution cipher that uses shifting?
                  What about the number of possible alphabets in a substitution cipher that uses a mixed alphabet?
            }
            For a substitution cipher that uses shifting, there are 26 possible alphabets.
            Starting from the normal alphabet, it can be shifted by one inder $26$ times before it is at its begin state again.
            For a substitution cipher that uses a mixed alphabet, there are $26!$ possible alphabets,
            that translates to about $4.0329 \times 10^{26}$ possible alphabets.

      \item \textbf{Does applying a significant number of consecutive simple substitution cipher
                  encryptions/decryptions with a mixed or shifted alphabet make it harder to break the original plaintext?
                  Justify your answer.
            }
            No, applying a significant number of consecutive simple substitution cipher encryptions/decryptions
            with both mixed or shifted alphabet does not make it harder to break the original plaintext.
            It will not make it easier either.
            This is because every character is still directly mapped to another character.
            An R mapped to a Q which is then mapped to a W, is the same as an R mapped to a W.
            The same goes for a shifted alphabet, A shift of $8$ followed by a shift of $-2$ is the same as a shift of $6$.
            The one and only possible benefit is that with multiple iterations you can use multiple alphabets.
            So you can give two or more people different alphabets and they can work together to encrypt the plaintext
            and decrypt when done in reverse order. The power it would take to break the text is the same with any
            amount of encryptions/decryptions. The only difference is that it would take longer to decrypt the text with the set of keys/alphabets.

      \item \textbf{Can the encryption function of the substitution cipher also be used for decryption? If so, how?}
            Yes, the encryption function of the substitution cipher can also be used for decryption.
            By running the encryption function with the same key multiple times, the plaintext will eventualy be returned.
            With a shift of $1$, the plaintext will be returned after $26$ iterations for example.
            This will also apply to mixed alphabets, after a maximum of $26$ iterations, $26$ individual mapping loops have been made.
            So after $26$ iterations, the plaintext will definitely be returned and in some cases earlier.

\end{enumerate}

\section*{Exercise 4}

\begin{lstlisting}
            
import sys


def encrypt(key, text):
    # encrypt text using given key
    counter = 0
    newText = []
    for i in range(len(text)):
        # continue if character is alphanumeric
        if text[i].isalpha():
            start = ord('A') if text[i].isupper() else ord('a')
            newText.append(chr(
                ((ord(text[i]) - start + ord(key[counter % len(key)]) - ord('a')) % 26) + start))
            counter += 1
        else:
            newText.append(text[i])
    print(''.join(newText))


def decrypt(key, text):
    # decrypt text using given key
    counter = 0
    newText = []
    for i in range(len(text)):
        # continue if character is alphanumeric
        if text[i].isalpha():
            start = ord('A') if text[i].isupper() else ord('a')
            newText.append(chr(
                ((ord(text[i]) - start - ord(key[counter % len(key)]) + ord('a')) % 26) + start))
            counter += 1
        else:
            newText.append(text[i])
    print(''.join(newText))


def handle_input(ende, key, input):
    if(ende == 'd'):
        decrypt(key, input)
    elif(ende == 'e'):
        encrypt(key, input)
    else:
        print("Invalid input")


def main():
    ende = ''
    key = ''
    input = ''
    # get input text
    for line in sys.stdin:
        if key == '':
            ende, key = line.strip().split(' ')
        elif line.strip() == '':
            handle_input(ende, key, input)
        else:
            input = input + line


if __name__ == "__main__":
    main()


\end{lstlisting}

\section*{Exercise 5}

\begin{lstlisting}

import re
import sys
import numpy as np

def textToKeyMatrix(text, keySize):
    # transform EncText to ndarray with shape (n, keySize)
    return np.array(list(text)[:len(text)-len(text) % keySize]).reshape(int(len(text)/keySize), keySize)


def replaceNonAlphaChars(text):
    # replace non alpha chars with dash
    return re.sub(r'[^a-zA-Z]', '-', text)


def occurencePerColumn(matrix):
    # calculate occurrences of each alphabetic character per column
    totalOccurences = []
    for i in range(matrix.shape[1]):
        occurences = np.unique(matrix[:, i], return_counts=True)
        # remove dashes from occurences if present
        if '-' in occurences[0]:
            occurences = (np.delete(occurences[0], np.where(
                occurences[0] == '-')), np.delete(occurences[1], np.where(occurences[0] == '-')))
        totalOccurences.append(occurences)
    return totalOccurences


def getMostFreqCharPerColumn(occurencePerColumn):
    # get most frequent character per column
    return [occurencePerColumn[i][0][np.argmax(occurencePerColumn[i][1])] for i in range(len(occurencePerColumn))]


def stdTotalSum(occurrences):
    # calculate the standard deviation of each column
    stds = np.array([np.std([int(count) for count in occurrences[i][1]])
                    for i in range(len(occurrences))])

    # return sum of max occurrences
    return np.sum(stds)


def getKeyShifts(mostFreqChars, mostFreqChar='e'):
    # get the shift of each character to the most frequent character
    return [ord(mostFreqChars[i]) - ord(mostFreqChar) for i in range(len(mostFreqChars))]


def keyShiftsToKey(keyShifts):
    # get the key from the key shifts
    return ''.join([chr((keyShifts[i] + 26) % 26 + ord('a')) for i in range(len(keyShifts))])


def printResultOf(input):
    minKeySize = int(input[0])
    maxKeySize = int(input[1])
    highestSTDSum = 0
    bestCharFreq = None
    # iterate over all possible key sizes
    for ks in range(minKeySize, maxKeySize + 1):
        charFreq = occurencePerColumn(
            textToKeyMatrix(replaceNonAlphaChars(input[2]), ks))
        totalSTDSum = stdTotalSum(charFreq)
        # keep track of the highest std sum
        if totalSTDSum > highestSTDSum:
            highestSTDSum = totalSTDSum
            bestCharFreq = charFreq
        print("The sum of %d std. devs: %s" %
              (ks, "{:.2f}".format(totalSTDSum)))

    print("Key guess:")
    print(keyShiftsToKey(getKeyShifts(getMostFreqCharPerColumn(bestCharFreq), 'e')))


def handle_input(input):
    if len(input) >= 3:
        printResultOf(input)
    else:
        print("Invalid input")


def main():
    totalInput = []
    # get input text
    for line in sys.stdin:
        if line == '\n':
            break
        totalInput.append(line.strip())
    handle_input([totalInput[0], totalInput[1], ''.join(totalInput[2:])])


if __name__ == "__main__":
    main()


\end{lstlisting}


\end{document}
