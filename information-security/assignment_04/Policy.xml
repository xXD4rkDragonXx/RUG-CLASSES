<?xml version="1.0" encoding="UTF-8"?>
<Policy
      xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17
        http://docs.oasis-open.org/xacml/3.0/xacml-core-v3-schema-wd-17.xsd"
      PolicyId="urn:oasis:names:tc:xacml:3.0:policy1"
      RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides" Version="1.0">
    <Description/>
    <Target>
         <AnyOf>
           <AllOf>
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Manager</AttributeValue>
                    <AttributeDesignator
                              Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                              AttributeId="urn:oasis:names:tc:xacml:1.0:subject:role"
                              DataType="http://www.w3.org/2001/XMLSchema#string"
                              MustBePresent="true"/>
               </Match>
            </AllOf>
         </AnyOf>
         <AnyOf>
           <AllOf>
                <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                    <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Report1</AttributeValue>
                    <AttributeDesignator 
                              Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                              AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"
                              DataType="http://www.w3.org/2001/XMLSchema#string"
                              MustBePresent="true"/>
                </Match>
         </AllOf>
      </AnyOf>
    </Target>
    <Rule RuleId="urn:oasis:names:tc:xacml:3.0:example:ruleid:rule1" Effect="Deny">
        <Target>
           <AnyOf>
             <AllOf>
                 <Match  MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                      <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">C</AttributeValue>
                      <AttributeDesignator 
                                Category="urn:oasis:names:tc:xacml:3.0:subject-category:access-subject"
                                AttributeId="urn:oasis:names:tc:xacml:1.0:subject:client"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                MustBePresent="false"/>
                 </Match>
             </AllOf>
           </AnyOf>
           <AnyOf>
              <AllOf>
                  <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:boolean-equal">
                      <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
                      <AttributeDesignator
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                AttributeId="urn:oasis:names:tc:xacml:1.0:resource:confidential"
                                DataType="http://www.w3.org/2001/XMLSchema#boolean"
                                MustBePresent="false"/>
                  </Match>
              </AllOf>
           </AnyOf>
        </Target>
    </Rule>
    <Rule RuleId="urn:oasis:names:tc:xacml:3.0:example:ruleid:allowRule" Effect="Permit"/>
</Policy>